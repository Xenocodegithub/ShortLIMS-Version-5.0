
@model IList<LIMS_DEMO.Areas.Arrival.Models.FinalReportModel>
@{
    ViewBag.Title = "Final Reports";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="main-container">
    <div class="pd-ltr-20 xs-pd-20-10">
        <div class="min-height-200px">
            <div class="page-header">
                <div class="row">
                    <div class="col-md-6 col-sm-12">
                        <div class="title">
                            <h4>Final Reports</h4>
                        </div>
                        <nav aria-label="breadcrumb" role="navigation">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index.html">Final Reports</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Final Reports</li>
                                <li class="breadcrumb-item active" aria-current="page">Final Reports List</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
            <!-- Default Basic Forms Start -->
            <div class="pd-20 card-box mb-30">
                <div class="clearfix">
                    <div class="pull-left">
                        <h4 class="text-blue h4">Final Reports List</h4>
                        <p class="mb-30">@*All bootstrap element classies*@</p>
                    </div>
                </div>

                <table id="dtHorizontalExample" class="table table stripe hover nowrap">
                    <thead>
                        <tr class="thead-dark">
                            <th class="table-plus datatable-nosort">
                                SrNo.
                            </th>
                            <th>
                                Sample Type
                            </th>
                            <th>
                                Sample Location
                            </th>
                            <th>
                                Customer Name
                            </th>
                            <th>
                                Contact Number
                            </th>
                            <th>
                                Sample ID
                            </th>
                            <th>
                                WorkOrder No.
                            </th>
                            <th>
                                Status
                            </th>
                            <th>
                                Test Report
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Model.Count; i++)
                        {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].SerialNo)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].SampleTypeProductName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].SampleLocation)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].CustomerName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].ContactNO)
                                </td>
                                <td>
                                    @Html.HiddenFor(modelItem => Model[i].SampleNo)
                                    @Html.HiddenFor(modelItem => Model[i].EnquiryId)
                                    @Html.DisplayFor(modelItem => Model[i].SampleName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].WorkOrderNo)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => Model[i].CurrentStatus)
                                </td>
                                <td>
                                    @if (Model[i].Url.ToString().Trim() == "Stack Emission")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=StackEmissionReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=StackEmissionReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1" class="btn btn-danger btn-sm " data-toggle="tooltip" data-placement="top" title="" style="display:block"> Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Wastewater")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterEffluents_singleReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterEffluents_singleReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">   Print NABL  </a>

                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Drinking Water/Potable Water /Domestic Water" || Model[i].Url.ToString().Trim() == "Ground Water" || Model[i].Url.ToString().Trim() == "Construction Water" || Model[i].Url.ToString().Trim() == "Industrial Water" || Model[i].Url.ToString().Trim() == "Wastewater"
                                     || Model[i].Url.ToString().Trim() == "Irrigation Water" || Model[i].Url.ToString().Trim() == "Packaged Drinking Water" || Model[i].Url.ToString().Trim() == "Surface Water" || Model[i].Url.ToString().Trim() == "Swimming Pool Water" || Model[i].Url.ToString().Trim() == "Water from Purifiers"
                                     || Model[i].Url.ToString().Trim() == "Water for Medicinal Purpose" || Model[i].Url.ToString().Trim() == "Disilled/Deminarilized Water" || Model[i].Url.ToString().Trim() == "Other Water" || Model[i].Url.ToString().Trim() == "Domestic Effluent" || Model[i].Url.ToString().Trim() == "Industrial Effluent")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterEffluents_singleReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm " data-toggle="tooltip" data-placement="top" title="" style="display:block;">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterEffluents_singleReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm " data-toggle="tooltip" data-placement="top" title="" style="display:block;">   Print NABL  </a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Ambient Air")
                                    {
                                        <select class="form-control" id="@string.Concat("SelectShift",i)" name="@string.Concat("SelectShift",i)">
                                            <option value="Select Shift" disabled>Select Shift</option>
                                            <option value="Shift1">24 Hours</option>
                                            <option value="Shift2">8 Hours</option>
                                        </select>
                                        <a href="" class="btn btn-info btn-sm" style="display:block" data-toggle="tooltip" data-placement="top" onclick="GetShiftDataTestNonNabl(@i,@Model[i].SampleCollectionId,@Model[i].WOMasterSampleCollectionDateId,@Model[i].SampleTypeProductId,@Model[i].EnquiryDetailId,0);">Print Non NABL</a>
                                        <a href="" class="btn btn-danger btn-sm" style="display:block" data-toggle="tooltip" data-placement="top" onclick="GetShiftDataTestNabl(@i,@Model[i].SampleCollectionId,@Model[i].WOMasterSampleCollectionDateId,@Model[i].SampleTypeProductId,@Model[i].EnquiryDetailId,1);">Print NABL</a>

                                        @*<a target="_blank" href="/Reporting/frmShowReport.aspx?path=AAQReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0" class="btn btn-primary alignleft" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                    <a target="_blank" href="/Reporting/frmShowReport.aspx?path=AAQReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1" class="btn btn-danger alignleft" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>*@
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Solid Waste" || Model[i].Url.ToString().Trim() == "Hazardous Waste")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=Solid_Hazardous_waste_foodReport.rdl&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleCollectionId=@Model[i].SampleCollectionId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=Solid_Hazardous_waste_foodReport.rdl&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleCollectionId=@Model[i].SampleCollectionId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Soil" || Model[i].Url.ToString().Trim() == "Sediment" || Model[i].Url.ToString().Trim() == "Used Oil" || Model[i].Url.ToString().Trim() == "Waste Oil")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=AREPORTSoil.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=AREPORTSoil.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Food")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=FoodReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=FoodReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Coal" || Model[i].Url.ToString().Trim() == "Coke" || Model[i].Url.ToString().Trim() == "Charcoal" || Model[i].Url.ToString().Trim() == "Briquettes" || Model[i].Url.ToString().Trim() == "Other Solid fuel")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=Coal_Report.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=Coal_Report.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Admixture" || Model[i].Url.ToString().Trim() == "Cement" || Model[i].Url.ToString().Trim() == "Fly Ash" || Model[i].Url.ToString().Trim() == "Workplace Air" || Model[i].Url.ToString().Trim() == "Fugitive Emission"
                                        || Model[i].Url.ToString().Trim() == "Workplace Air/Indoor Air Quality" || Model[i].Url.ToString().Trim() == "Air Monitoring" || Model[i].Url.ToString().Trim() == "Surface Swabs")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterCombinedReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&MatrixName=@Model[i].Url&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0&EnquiryId=@Model[i].EnquiryId" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print Non NABL</a>
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=WaterCombinedReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&MatrixName=@Model[i].Url&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=1&EnquiryId=@Model[i].EnquiryId" class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print NABL</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Ambient Noise Level" || Model[i].Url.ToString().Trim() == "Workplace Noise Level")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=AmbientWorkplaceTestReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&MatrixName=@Model[i].Url&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print</a>
                                    }
                                    else if (Model[i].Url.ToString().Trim() == "Source Noise Level")
                                    {
                                        <a target="_blank" href="/Reporting/frmShowReport.aspx?path=SourceNoiseTestReport.rdl&SampleCollectionId=@Model[i].SampleCollectionId&WOMasterSampleCollectionDateId=@Model[i].WOMasterSampleCollectionDateId&SampleTypeProductId=@Model[i].SampleTypeProductId&MatrixName=@Model[i].Url&EnquiryDetailId=@Model[i].EnquiryDetailId&IsNablSave=0" class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="" style="display:block">Print</a>
                                    }
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <!-- Default Basic Forms End -->
        </div>
    </div>
</div>

<script>

    function GetShiftDataTestNonNabl(i, SampleCollectionId, WOMasterSampleCollectionDateId, SampleTypeProductId, EnquiryDetailId, n) {

        var SampleCollectionId = SampleCollectionId;
        var m = "#SelectShift" + i;
        var shiftName = $(m).val();
        var ShiftNo = 0;
        if (shiftName == "Shift1") {
            ShiftNo = 1;
        }
        else if (shiftName == "Shift2") {
            ShiftNo = 2;
        }
        else {
            ShiftNo = 3;
        }

        if (ShiftNo == 1) {
            $.ajax({
                type: "POST",
                success: function () {
                    var x = "/Reporting/frmShowReport.aspx?path=AAQReport24hrs.rdl&SampleCollectionId=" + SampleCollectionId + "&WOMasterSampleCollectionDateId=" + WOMasterSampleCollectionDateId + "&SampleTypeProductId=" + SampleTypeProductId + "&EnquiryDetailId=" + EnquiryDetailId + "&IsNablSave=" + n + "&ShiftNo=" + ShiftNo + "";
                    window.location = x;
                }
            })
        }

        if (ShiftNo == 2) {
            $.ajax({
                type: "POST",
                success: function () {
                    var x = "/Reporting/frmShowReport.aspx?path=AAQReport8hrs.rdl&SampleCollectionId=" + SampleCollectionId + "&WOMasterSampleCollectionDateId=" + WOMasterSampleCollectionDateId + "&SampleTypeProductId=" + SampleTypeProductId + "&EnquiryDetailId=" + EnquiryDetailId + "&IsNablSave=" + n + "&ShiftNo=" + ShiftNo + "";
                    window.location = x;
                }
            })
        }
    };

    function GetShiftDataTestNabl(i, SampleCollectionId, WOMasterSampleCollectionDateId, SampleTypeProductId, EnquiryDetailId, n) {
        debugger
        var SampleCollectionId = SampleCollectionId;
        var m = "#SelectShift" + i;
        var shiftName = $(m).val();
        var ShiftNo = 0;
        if (shiftName == "Shift1") {
            ShiftNo = 1;
        }
        else if (shiftName == "Shift2") {
            ShiftNo = 2;
        }
        else {
            ShiftNo = 3;
        }
        if (ShiftNo == 1) {
            $.ajax({
                type: "POST",
                success: function () {
                    var x = "/Reporting/frmShowReport.aspx?path=AAQReport24hrs.rdl&SampleCollectionId=" + SampleCollectionId + "&WOMasterSampleCollectionDateId=" + WOMasterSampleCollectionDateId + "&SampleTypeProductId=" + SampleTypeProductId + "&EnquiryDetailId=" + EnquiryDetailId + "&IsNablSave=" + n + "&ShiftNo=" + ShiftNo + "";
                    window.location = x;
                }
            })
        }

        if (ShiftNo == 2) {
            $.ajax({
                type: "POST",
                success: function () {
                    var x = "/Reporting/frmShowReport.aspx?path=AAQReport8hrs.rdl&SampleCollectionId=" + SampleCollectionId + "&WOMasterSampleCollectionDateId=" + WOMasterSampleCollectionDateId + "&SampleTypeProductId=" + SampleTypeProductId + "&EnquiryDetailId=" + EnquiryDetailId + "&IsNablSave=" + n + "&ShiftNo=" + ShiftNo + "";
                    window.location = x;
                }
            })
        }
    };
</script>
<script>
    $(document).ready(function () {
        $('#dtHorizontalExample').DataTable({
            "scrollX": true
        });
        $('.dataTables_length').addClass('bs-select');
    });
</script>